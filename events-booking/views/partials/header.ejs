<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="google-signin-client_id" content="456515688442-f92dp1vudi369d67j8hredi65a6sianu.apps.googleusercontent.com">
  <title>Document</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
  <script src="https://code.iconify.design/3/3.1.0/iconify.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
  <script src="/nav.js"></script>
  <!--<script src="/swiper.js"></script>-->
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"
/>
  <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Open+Sans" />
  <link rel="stylesheet" href="/styles.css">
  <link rel="stylesheet" href="/wallet.css">
  <link rel="stylesheet" href="/events.css">
  <link rel="stylesheet" href="/cart.css">


  <!--<link rel="stylesheet" href="/ticket.css"> -->    <!--Non ho ancora capito come gestici i css, ricordami di chiedertelo-->
</head>
<body>
  <nav>
    <h1><a href="/">Event booking</a></h1>
    <input type="text" class="search-input" id="searchInput" placeholder="Search artist..." style="overflow: hidden;">
    <% if(user) { %>
    <div id="drop-menu">
			<ul id="menu">
				<li><a href="/home">Home</a></li>
				<li><a id="user_name_menu" href="/user/<%=user._id%>"><%=user.name %></a>
          <ul class="menu__profile">      
          <!-- Manage events solo un utente admin può visualizzarla-->
          <% if(user.role === 1) { %>
            <li><a href="home" class="btn-yellow-hover">Manage events</a></li> <!--Porta alla pagina per modificare, eliminare e inserire eventi--> 
            <% } %>
            <li><a href="/user/<%=user._id%>">My Profile</a></li>
            <li><a href="#">My Bookings</a></li>
            <li><a href="/user/<%=user._id%>/wallet">My Wallet</a></li>
            <li><a href="/logout">Log out</a></li>
          </ul>
        </li>
        <li><span id="span_cart"><i class="fa-solid fa-cart-shopping fa-lg"></i></span></li>
        <div class="cart-indicator" id="cart-indicator">
          <% if(typeof cart === 'undefined') { %> 
              0 
          <% } else { %> 
            <% let count=0;
            cart.forEach(function(item) { %>
              <% count += item.quantity; 
              });%>
              <%= count %> 
          <% } %>
        </div>
        <!-- La sezione del carrello -->
        <div id="overlay"></div>
        <div id="cartSection" class="cart-section">  <!-- Contenuto del carrello -->  
          <span class="close">&times;</span>  
          <h2 class="h2_cart">Cart Details</h2>
          <ul class="menu__cart" id="cart">
            <div class="empty-cart">
                <p>Your cart is empty</p>
            </div>
            <% if(typeof cart != 'undefined') { %>
              <% cart.forEach(function(event) { %>
                <li class="li_cart" data-id="<%= event.event_id %>">
                    <div class="cart-item">
                        <img src="<%= event.event_img %>" alt="img event" class="cart-item__image">
                        <div class="cart-item__info">
                            <p><%= event.title %></p>
                            <p>x<%= event.quantity %></p>
                            <p><%= event.price %>€</p>
                        </div>
                        <div class="delete_item_cart">
                          <i class="fa-solid fa-trash-can"></i>
                        </div>
                    </div>
                </li>
            <% }) } %>
          </ul>
        </div>
		  </ul> 
		</div>
    <% } else { %>
    <ul id="menu">
      <li><a href="/login" class="btn-yellow-hover">Log in</a></li>
      <li><a href="/signup" class="btn-yellow-hover">Sign up</a></li>
    </ul>
    <% } %>
  </nav>

